# Notes Backend (FastAPI)

FastAPI backend for the Personal Notes Manager. Provides JWT-based authentication and CRUD APIs for notes with SQLite persistence via SQLAlchemy.

## Features
- User registration and login with hashed passwords (bcrypt)
- JWT bearer authentication
- Notes CRUD (create, read, update, delete)
- Pagination and simple search (`q`) on title/content
- CORS configured for `http://localhost:3000`
- OpenAPI docs at `/docs` and `/openapi.json`
- Dev seed user: `demo@example.com` / `password123` (only if no users exist and `ENV=dev` or unset)

## Requirements
- Python 3.10+
- pip

## Setup

1. Create and activate a virtual environment (recommended).
2. Install dependencies:
   pip install -r requirements.txt

3. (Optional) Copy `.env.example` to `.env` and set variables:
   - `SECRET_KEY` (required for production; autogenerated fallback in dev)
   - `ACCESS_TOKEN_EXPIRE_MINUTES` (default 60)
   - `FRONTEND_ORIGIN` (default http://localhost:3000)
   - `DATABASE_URL` (default sqlite:///./notes.db)

4. Run the API (port 3001 recommended):
   uvicorn src.api.main:app --host 0.0.0.0 --port 3001 --reload

5. Open the docs:
   http://localhost:3001/docs

## API Summary

- Health:
  - GET `/` — Service health

- Auth:
  - POST `/auth/register` — body: `{ email, password }`
  - POST `/auth/login` — form: `username` (email), `password`; returns `{ access_token, token_type }`

- Notes (Authorization: Bearer <token>):
  - GET `/notes?page=1&page_size=10&q=search` — list notes (paginated)
  - POST `/notes` — body: `{ title, content }` — create note
  - GET `/notes/{id}` — get note by id
  - PUT `/notes/{id}` — body: `{ title?, content? }` — update
  - DELETE `/notes/{id}` — delete (204)

## Development Tips
- A dev seed user is automatically created at startup if there are no users.
- For non-SQLite databases, install the appropriate drivers and set `DATABASE_URL`.
- Regenerate OpenAPI spec into `interfaces/openapi.json`:
   python -m src.api.generate_openapi
